{% extends 'splunkdj:base_with_app_bar.html' %}

{% load splunkmvc %}

{% load vmap %}

{% block css %}
<link rel="stylesheet" type="text/css" href="{{STATIC_URL}}{{app_name}}/custom.css" />
<link rel="stylesheet" type="text/css" href="{{STATIC_URL}}splunkjs/css/dashboard.css" />
{% endblock css %}

{% block title %}{{your_app_name}}A Fancy Map{% endblock title %}

{% block content %}
<div class="dashboard-body container-fluid main-section-body">
	<div class="row">
        <div class="dashboard-header clearfix">
            <h2> Big Map</h2>
        </div>
    </div>
     <div class="dashboard-row">
        <div class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel">
                <div class="panel-head">
                    <h3>AQI Map</h3>
                </div>
                <div class="panel-body">

    {% vmap id="mymap" 
    	tileSource="openStreetMap"
    	maptype="default"
    	managerid="search1" 
		fillcolor="silver" 
		valueField="aqi"
		groupField="area"
		nameField="name"
		destFormField="area"
		height=650

		%}
				</div>
            </div>
        </div>
        <div class="dashboard-cell" style="width: 0%;">
            <div class="dashboard-panel">
            </div>
        </div>
    </div>
</div>
{% endblock content %}

	
{% block managers %}

{% searchmanager id="search1" search="index=aqicn | stats latest(aqi) as aqi by area | geocncity area | stats max(aqi) as aqi by area city_lat city_lng | rename area as name city_lat as latitude city_lng as longitude" preview=True %}
{% endblock managers %}



 